<?xml version="1.0" encoding="utf-8"?>
<openerp>
    <data>

        <template id="assets_editor_custom_css" inherit_id="website.layout">
            <xpath expr="//head" position="inside">
                <style>
                    #title {
                        min-height: 300px !important;
                        max-height: 500px !important;
                    }
                </style>
            </xpath>
        </template>

        <!-- inherit blog_post_complete -->
        <template id="blog_post_complete" inherit_id="website_blog.blog_post_complete" name="Blog Post">
            <xpath expr="//div[@id='title']" position="replace">
                <div class="mt32 mb32">
                    <div class="container blog_post" style="padding: 0px;">
                        <div class="col-md-12 col-sm-12 col-xs-12">

                            <!-- blog post body -->
                            <div class="col-md-9 col-sm-9 col-xs-12" style="padding: 5px;">
                                <div class="col-md-12 col-sm-12 col-xs-12 oe_dark">
                                    <div class="blog_title">
                                        <h1 t-field="blog_post.name" id="blog_post_name" class="text-center" t-att-data-blog-id="blog_post.id"/>
                                        <h2 t-field="blog_post.subtitle"/>
                                        <p class="post-meta text-muted text-center" name="blog_post_data"/>
                                        <div class="hidden">
                                            <img itemprop="image" t-att-src="website.simple_blog_url(blog_post, 'website_blog_simple.im_blog_list')" style="margin: auto; padding: 0px;"/>
                                            <span t-field="blog_post.author_id" style="display: inline-block;" t-field-options='{
                                                "widget": "contact",
                                                "fields": ["name"]
                                            }'/>
                                        </div>
                                    </div>

<!--
                                    <div id="title" t-if="blog_post.background_image and not str(blog_post.background_image)[:4] == 'http'" class="cover js_fullheight mt16" t-attf-style="background-image: url(website.imagemagick_url(blog_post, 'background_image', 'website_blog_simple.im_blog_single'))">
-->
                                    <div itemscope="itemscope" itemtype="http://schema.org/Product" id="wrap" class="js_sale">
                                        <t t-set="bg_url" t-value="website.imagemagick_url(blog_post, 'background_image', 'website_blog_simple.im_blog_single')"/>

                                        <span itemprop="image" class="cke_widget_editable cke_widget_element oe_editable oe_dirty" contenteditable="true" t-field="blog_post.image" t-field-options='{"widget": "image", "class": "product_detail_img", "alt-field": "name"}'/>

<!--
                                        <div class="container">
                                              <div class="container text-right mt16">
                                                <div class="btn-group css_non_editable_mode_hidden">
                                                    <a id="change_cover" class="btn btn-primary">
                                                        Change Cover
                                                    </a>
                                                    <a id="clear_cover" class="btn btn-danger">
                                                        <span class="fa fa-times"/>
                                                    </a>
                                                </div>
                                                <div class="cover-storage oe_hidden"></div>
                                                <t t-call="website.publish_management">
                                                    <t t-set="object" t-value="blog_post"/>
                                                    <t t-set="publish_edit" t-value="True"/>
                                                    <li>
                                                        <form class="duplicate hidden" action="/blogpost/duplicate">
                                                            <input name="blog_post_id" t-att-value="blog_post.id"/>
                                                        </form>
                                                        <a href="#" class="duplicate" onclick="$(this).prev('form').submit()">Duplicate</a>
                                                    </li>
                                                </t>
                                            </div>
                                        </div>
-->
                                    </div>
                                    <div t-if="blog_post.background_image" id="blog_angle_down" class="hidden">
                                        <strong><a href="#blog_content" class="fa fa-angle-down fa-3x fa-inverse mt32"/></strong>
                                    </div>
                                    <div t-field="blog_post.content" class="mt32 col-md-12 col-sm-12 col-xs-12"/>
                                    <div>
                                        <h5 t-field="blog_post.write_uid" class="pull-left"/>
                                        <h5 t-field="blog_post.write_date" class="pull-right"/>
                                    </div>
                                </div>
                            </div>

                            <!-- blog post list -->
                            <div class="col-md-3 col-sm-3 col-xs-12" style="padding: 5px;">
                                <t t-set="blog_post_list" t-value="request.env['blog.post'].sudo().search([('blog_id', '=', blog.id)])"/>
                                <t t-foreach="blog_post_list" t-as="b">
                                    <a t-if="b.website_published == True or user_id.has_group('base.group_website_publisher')" t-att-href="'/blog/%s/post/%s' % (blog.id, b.id)">
                                        <div class="col-sm-12 oe_dark mb16" t-att-style="'padding: 0px; %s' % 'border: 1px solid #f00; opacity: 0.5;' if b.website_published == False else ''">
                                            <div class="col-md-3 col-sm-3 col-xs-3" style="padding: 5px;">
                                                <img itemprop="image" t-att-src="website.simple_blog_url(b, 'website_blog_simple.im_blog_list')" style="margin: 10px auto auto; padding: 0px;"/>
                                            </div>
                                            <div class="col-md-9 col-sm-9 col-xs-9">
                                                <h4 t-field="b.name"/>
                                                <h5 t-field="b.subtitle"/>
                                                <h6 t-field="b.write_date"/>
                                            </div>
                                        </div>
                                    </a>
                                </t>
                            </div>
                        </div>
                    </div>
                </div>
            </xpath>

            <xpath expr="//div[@id='blog_content']" position="attributes">
                <attribute name="class">hidden</attribute>
            </xpath>

            <xpath expr="//div[@class='cover cover_footer mb0 text-center']" position="attributes">
                <attribute name="class">cover cover_footer mb0 text-center hidden</attribute>
            </xpath>
        </template>

        <template id="assets_editor_custom_js" inherit_id="website.assets_editor" name="Blog Editor" groups="base.group_website_publisher">
            <xpath expr="." position="inside">
                <script type="text/javascript" src="/website_blog/static/src/js/website_blog.editor.js"></script>
                <script type="text/javascript" src="/website_blog/static/src/js/website.tour.blog.js"></script>
            </xpath>
        </template>

    </data>
</openerp>
